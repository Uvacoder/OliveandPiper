<div class="container">
  <div class="row image-bar">
    {% for block in section.blocks %}

      {% case section.blocks.size %}
        {% when 1 %}
          {%- assign column_size = 'col-sm-12 col-md-12 image-bar--single-image' -%}
          {% assign img_main_size = '2048' %}
          {% assign img_mob_size = '400' %}
          {% assign img_tablet_size = '790' %}
          {% assign img_sizes = "60vw" %}
        {% when 2 %}
          {%- assign column_size = ' col-xs-6 col-sm-6 col-md-6' -%}
          {% assign img_main_size = '1024' %}
          {% assign img_mob_size = '200' %}
          {% assign img_tablet_size = '790' %}
          {% assign img_sizes = "50vw" %}
        {% when 3 %}
          {%- assign column_size = 'col-sm-4 col-md-4' -%}
          {% assign img_main_size = '680' %}
          {% assign img_mob_size = '400' %}
          {% assign img_tablet_size = '270' %}
          {% assign img_sizes = "(max-width: 768px) 100vw, (min-width: 992px) 33.3vw, 33.3vw" %}
        {% else %}
          {%- assign column_size = 'col-sm-6 col-md-3' -%}
          {% assign img_main_size = '512' %}
          {% assign img_mob_size = '400' %}
          {% assign img_tablet_size = '400' %}
          {% assign img_sizes = "(max-width: 767px) 100vw, 50vw" %}
      {% endcase %}

      <div class="grid__item {{ column_size }}" {{ block.shopify_attributes }}>
        {% if block.settings.image != blank %}
          {% assign img_url_main_size = img_main_size | append: 'x' %}
          {% assign img_url_mob_size = img_mob_size | append: 'x' %}
          {% assign img_url_tablet_size = img_tablet_size | append: 'x' %}

          {%- assign img_url_main = block.settings.image | img_url: img_url_main_size -%}
          {%- assign img_url_mob = block.settings.image | img_url: img_url_mob_size -%}
          {%- assign img_url_tablet = block.settings.image | img_url: img_url_tablet_size  -%}
        {% else %}
          {%- assign img_url_main = '' -%}
        {% endif %}
        {% if block.settings.link != blank and img_url_main != blank %}
          <a href="{{ block.settings.link }}">
        {% else %}
          <div class="image-bar__item">
        {% endif %}

        <div class="image-bar__content">
          {% if img_url_main == blank %}
              {{ 'image' | placeholder_svg_tag: 'icon icon--placeholder' }}
          {% else %}
            <img src="{{ img_url_main }}" srcset="{{ img_url_mob }} {{ img_mob_size }}w,
                {{ img_url_tablet }} {{ img_tablet_size }}w,
                {{ img_url_main }} {{ img_main_size }}w" sizes="{{ img_sizes }}" class="img-responsive"/>
          {% endif %}
        </div>

        {% if block.settings.link != blank and img_url_main != blank %}
          </a>
        {% else %}
          </div>
        {% endif %}

        {% if block.settings.title %}
          <h3 class="image-bar--title">{{ block.settings.title }}</h3>
        {% endif %}

        {% if block.settings.description != '' %}
          <div class="image-bar--description">{{ block.settings.description }}</div>
        {% endif %}

      </div>

    {% endfor %}

    {% if section.blocks.size == 0 %}
      <div class="placeholder-noblocks">
        {{ 'general.onboarding.no_content' | t }}
      </div>
    {% endif %}

  </div>
</div>

{% schema %}
{
  "name": "Gallery",
  "class": "homepage-section--image-gallery-wrapper wow fadeIn",
  "max_blocks": 4,
  "blocks": [
    {
      "type": "image",
      "name": "Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image",
          "info": "1000 x 525px recommended"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link",
          "info": "Optional"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "info": "Optional"
        },
        {
          "type": "richtext",
          "id": "description",
          "label": "Description",
          "info": "Optional"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Gallery",
      "category": "Image",
      "blocks": [
        {
          "type": "image"
        },
        {
          "type": "image"
        },
        {
          "type": "image"
        }
      ]
    }
  ]
}
{% endschema %}
